<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Stash AI Design Agent</title>
    <!-- New M3 Stylesheet -->
    <link rel="stylesheet" href="index.css" />
    
    <!-- Icons -->
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    
    <!-- Brand Fonts -->
    <link rel="stylesheet" href="https://use.typekit.net/ioz2jko.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Lato:ital,wght@0,100;0,300;0,400;0,700;0,900;1,100;1,300;1,400;1,700;1,900&display=swap" rel="stylesheet" />

    <script type="importmap">
      {
        "imports": {
          "@google/genai": "https://aistudiocdn.com/@google/genai@^1.20.0"
        }
      }
    </script>
  </head>
  <body class="theme-dark m3">
    <div id="app" class="container" style="display: flex; flex-direction: column; gap: var(--m3-gap-5);">
      <!-- Header -->
       <header style="display: flex; justify-content: space-between; align-items: center;">
         <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAA2gAAAB5CAMAAAC3vj9AAAAABGdBTUEAALGPC/xhBQAAACBjSFJNAAB6JgAAgIQAAPoAAACA6AAAdTAAAOpgAAA6mAAAF3CculE8AAAAllBMVEX///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB6TqcCAAAAMnRSTlMA+hL5A/UnBvH28I52fWg/Lh8V6uG8n4t1b2RgW0k/JOnk4dzY1M/NzMXAu6+ro52bmXt3d2pZUEA9MzEgGxsLBwIB/aH2AAAAAWJLR0QAiAUdSAAAAAlwSFlzAAALEwAACxMBAJqcGAAAAAd0SU1FB+YLFBEyD/8SctwAAAWlSURBVHja7dzrdtu2FAbgFxC45JxzB0hISAgJgQRAAv//f6k6s1l2Xy2Ppwfpae17bC+2WJk+5eGHw+FwOBwOh8PhcDgci/EwDOPk/D58v+P32/f/g2GkKqWGUqU0lKmln1K5tJSmpZZSqZTS0Eqp0h+lViqlNdRSqtQilVLKRyslK1LdK1JbpZ6VK2UvUrFKNStZydqUqVStZCVrV6ZWtZKVrl2ZytZKVrp2ZWrbKVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrpmpWtZVrp-ghAAAAABJRU5ErkJggg==" alt="Stash Logo" style="max-width: 150px;">
         <div class="theme-switcher">
            <button class="m3-btn m3-btn--text" data-theme="light">Light</button>
            <button class="m3-btn m3-btn--text" data-theme="dark">Dark</button>
         </div>
      </header>
      
      <!-- Navigation -->
      <nav class="nav-tabs" role="tablist">
        <button id="nav-design-studio" class="m3-btn m3-btn--text m3-state active-tab" role="tab" aria-selected="true">
            <i class="material-icons">palette</i>
            <span>Design Studio</span>
        </button>
        <button id="nav-brand-kit" class="m3-btn m3-btn--text m3-state" role="tab" aria-selected="false">
            <i class="material-icons">style</i>
            <span>Brand Kit</span>
        </button>
        <button id="nav-automation" class="m3-btn m3-btn--text m3-state" role="tab" aria-selected="false">
            <i class="material-icons">schedule</i>
            <span>Automation</span>
        </button>
      </nav>
      
      <main>
        <!-- Design Studio Page -->
        <section id="design-studio-page" class="page active">
            <div class="row">
                <!-- Controls Card -->
                <div class="col">
                    <div class="m3-card" style="display: flex; flex-direction: column; gap: var(--m3-gap-5); flex-grow: 1;">
                        <div>
                            <h2 class="m3-headline-sm" style="color: var(--m3-on-surface-variant);">1. Upload Image</h2>
                            <div id="image-upload-area" style="border: 2px dashed var(--m3-outline); padding: 2rem; text-align: center; border-radius: var(--m3-shape-large); cursor: pointer; transition: background-color 0.2s ease; margin-top: var(--m3-gap-3);">
                                <i class="fas fa-cloud-arrow-up" style="font-size: 2.5rem; color: var(--m3-outline); margin-bottom: 1rem;"></i>
                                <p class="m3-body-lg" style="color: var(--m3-on-surface-variant);">Drag & drop or click to upload</p>
                            </div>
                            <input type="file" id="image-upload" class="hidden" accept="image/*">
                        </div>

                        <div>
                            <h2 class="m3-headline-sm" style="color: var(--m3-on-surface-variant);">2. Describe Your Design</h2>
                            <div class="m3-field" style="margin-top: var(--m3-gap-3);">
                                <label for="prompt-input">e.g., add a '50% Off' sale banner...</label>
                                <textarea id="prompt-input" rows="4"></textarea>
                            </div>
                        </div>

                        <div>
                             <h2 class="m3-headline-sm" style="color: var(--m3-on-surface-variant);">3. Add a Logo</h2>
                             <div id="logo-selection-container" class="grid grid-cols-4" style="background-color: var(--m3-surface-variant); padding: var(--m3-gap-2); border-radius: var(--m3-shape-large); margin-top: var(--m3-gap-3);">
                                <!-- Logos injected here -->
                            </div>
                        </div>

                        <button id="generate-btn" class="m3-btn m3-btn--filled m3-state" style="width: 100%; padding: 12px 0;">
                            <i class="material-icons">auto_awesome</i>
                            <span id="generate-btn-text">Generate Design</span>
                            <span id="generate-spinner" class="hidden"><i class="fas fa-spinner fa-spin"></i></span>
                        </button>
                    </div>
                </div>

                <!-- Image Display -->
                <div class="col">
                    <div class="m3-card">
                        <h2 class="m3-headline-sm" style="text-align: center; color: var(--m3-on-surface-variant); margin-bottom: var(--m3-gap-4);">Original Image</h2>
                        <div id="original-image-container" style="aspect-ratio: 1/1; display: flex; align-items: center; justify-content: center; background-color: var(--m3-surface-variant); border-radius: var(--m3-shape-medium);">
                            <span style="color: var(--m3-on-surface-variant);">Upload an image to start</span>
                        </div>
                    </div>
                    <div class="m3-card">
                        <h2 class="m3-headline-sm" style="text-align: center; color: var(--m3-on-surface-variant); margin-bottom: var(--m3-gap-4);">AI Generated Design</h2>
                         <div id="generated-image-container" style="aspect-ratio: 1/1; display: flex; align-items: center; justify-content: center; background-color: var(--m3-surface-variant); border-radius: var(--m3-shape-medium);">
                            <span style="color: var(--m3-on-surface-variant);">Your AI design will appear here</span>
                        </div>
                        <button id="download-btn" class="m3-btn m3-btn--filled m3-state hidden" style="width: 100%; margin-top: var(--m3-gap-4);">
                            <i class="material-icons">download</i>
                            <span>Download Image</span>
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Brand Kit Page -->
        <section id="brand-kit-page" class="page">
             <div class="row">
                <div class="col">
                    <div class="m3-card">
                        <h2 class="m3-title-lg" style="margin-bottom: var(--m3-gap-4);">Style Guidelines</h2>
                        <div class="m3-field">
                            <label for="style-guidelines-input">Brand voice, rules, etc.</label>
                            <textarea id="style-guidelines-input" rows="10"></textarea>
                        </div>
                        <button id="save-guidelines-btn" class="m3-btn m3-btn--filled m3-state" style="margin-top: var(--m3-gap-4); width: 100%;">
                            <span>Save Guidelines</span>
                        </button>
                    </div>
                    <div class="m3-card">
                        <h2 class="m3-title-lg" style="margin-bottom: var(--m3-gap-4);">Brand Colors</h2>
                        <div style="display: flex; align-items: center; gap: var(--m3-gap-4); margin-bottom: var(--m3-gap-4);">
                            <input type="color" id="color-picker" style="min-width: 48px; height: 48px; border: none; background: none; border-radius: var(--m3-shape-small); cursor: pointer;" value="#e11f1f">
                            <div class="m3-field" style="flex-grow: 1;">
                                <label for="color-hex-input">Hex Code</label>
                                <input type="text" id="color-hex-input">
                            </div>
                            <button id="add-color-btn" class="m3-btn m3-btn--outlined m3-state">
                                <span>Add</span>
                            </button>
                        </div>
                        <div id="brand-colors-container" class="grid grid-cols-4 md-grid-cols-3"></div>
                    </div>
                    <div class="m3-card">
                        <h2 class="m3-title-lg" style="margin-bottom: var(--m3-gap-4);">Brand Logos</h2>
                        <div id="logo-upload-area" style="text-align: center; padding: 1.5rem; margin-bottom: 1rem; border: 2px dashed var(--m3-outline); border-radius: var(--m3-shape-large); cursor: pointer;">
                            <i class="material-icons" style="font-size: 3rem; color: var(--m3-outline);">add_photo_alternate</i>
                            <p class="m3-body-lg" style="color: var(--m3-on-surface-variant);">Upload Logos</p>
                        </div>
                        <input type="file" id="logo-upload-input" class="hidden" accept="image/*" multiple>
                        <div id="brand-logos-container" class="grid grid-cols-2 md-grid-cols-3"></div>
                    </div>
                </div>
                 <div class="col">
                     <div class="m3-card">
                        <h2 class="m3-title-lg" style="margin-bottom: var(--m3-gap-4);">Product Catalog</h2>
                        <div style="margin-bottom: 1.5rem;">
                            <h3 class="m3-title-md" style="color: var(--m3-on-surface-variant);">Bulk Upload</h3>
                             <p class="m3-body-sm" style="margin-block: var(--m3-gap-2); color: var(--m3-on-surface-variant);">Name files as <strong>ProductName_Description.jpg</strong> to auto-fill.</p>
                             <input type="file" id="bulk-product-upload" multiple accept="image/*" class="w-full">
                        </div>
                        <hr style="border-color: var(--m3-outline-variant); margin-block: var(--m3-gap-4);">
                        <h3 class="m3-title-md" style="color: var(--m3-on-surface-variant);">Add Single Product</h3>
                        <div id="new-product-image-area" style="border: 2px dashed var(--m3-outline); border-radius: var(--m3-shape-large); cursor: pointer; padding: 1rem; text-align: center; margin-block: var(--m3-gap-3);">
                            <span id="new-product-image-text" style="color: var(--m3-on-surface-variant);">Click to upload product image</span>
                        </div>
                        <input type="file" id="new-product-image-upload" accept="image/*" class="hidden">
                        <div class="m3-field" style="margin-bottom: var(--m3-gap-4);">
                            <label for="new-product-name">Product Name</label>
                            <input id="new-product-name" type="text">
                        </div>
                         <div class="m3-field" style="margin-bottom: var(--m3-gap-4);">
                            <label for="new-product-description">Product Description</label>
                            <textarea id="new-product-description" rows="2"></textarea>
                        </div>
                        <button id="add-product-btn" class="m3-btn m3-btn--filled m3-state" style="width: 100%;">
                             <span>Add Product</span>
                        </button>
                        <div id="product-catalog-container" class="grid grid-cols-2 md-grid-cols-3" style="margin-top: 1.5rem;"></div>
                    </div>
                     <div class="m3-card">
                        <h2 class="m3-title-lg" style="margin-bottom: var(--m3-gap-4);">Design Templates</h2>
                         <div style="display: flex; gap: 1rem; margin-bottom: 1rem;">
                             <div class="m3-field" style="flex-grow: 1;">
                                 <label for="template-search-input">Search Templates</label>
                                 <input id="template-search-input" type="text" placeholder="Search...">
                             </div>
                             <button id="add-template-btn" class="m3-btn m3-btn--filled m3-state">
                                 <span>New</span>
                             </button>
                         </div>
                         <div class="row" style="height: 400px; border: 1px solid var(--m3-outline-variant); border-radius: var(--m3-shape-large); overflow: hidden;">
                             <div id="template-list-container" class="col" style="overflow-y: auto; background: var(--m3-surface); padding: var(--m3-gap-2);"></div>
                             <div id="template-preview-container" class="col" style="padding: var(--m3-gap-4);"></div>
                         </div>
                    </div>
                 </div>
            </div>
        </section>

        <!-- Automation Page -->
        <section id="automation-page" class="page">
           <div class="m3-card">
                <h2 class="m3-headline-sm" style="margin-bottom: var(--m3-gap-5);">Daily Design Automation</h2>
                <div class="row">
                    <div class="col">
                        <h3 class="m3-title-md" style="color: var(--m3-on-surface-variant);">Automation Controls</h3>
                        <div style="display: flex; align-items: center; gap: var(--m3-gap-4); padding: var(--m3-gap-4); background: var(--m3-surface-variant); border-radius: var(--m3-shape-large);">
                           <span id="automation-status-indicator" style="width: 12px; height: 12px; border-radius: 50%;"></span>
                           <span id="automation-status-text" class="m3-body-lg"></span>
                           <button id="automation-toggle-btn" class="m3-btn m3-btn--filled m3-state" style="margin-left: auto;">
                               <span id="automation-btn-text"></span>
                           </button>
                        </div>
                        <h3 class="m3-title-md" style="color: var(--m3-on-surface-variant);">Evergreen Prompt</h3>
                         <p class="m3-body-sm" style="color: var(--m3-on-surface-variant);">Use placeholders: [DATE], [DAY_OF_WEEK], [PRODUCT_NAME], [PRODUCT_DESCRIPTION]</p>
                         <div class="m3-field">
                            <label for="automation-prompt-input">e.g., Feature [PRODUCT_NAME] today...</label>
                            <textarea id="automation-prompt-input" rows="8"></textarea>
                        </div>
                    </div>
                    <div class="col">
                         <h3 class="m3-title-md" style="color: var(--m3-on-surface-variant);">Today's Status</h3>
                         <div id="automation-today-status" style="min-height: 50px; padding: var(--m3-gap-4); background-color: var(--m3-surface-variant); border-radius: var(--m3-shape-large);"></div>
                         <h3 class="m3-title-md" style="margin-top: 1.5rem; color: var(--m3-on-surface-variant);">Generated History</h3>
                         <div id="automation-history-container" class="grid grid-cols-2" style="max-height: 400px; overflow-y: auto; padding: 0.5rem;">
                            <!-- History items injected here -->
                         </div>
                    </div>
                </div>
            </div>
        </section>
      </main>

       <!-- Template Modal -->
        <div id="template-modal" class="m3-dialog-backdrop">
            <div class="m3-dialog" role="alertdialog" aria-modal="true" aria-labelledby="template-dialog-title">
                <div class="m3-dialog-header">
                    <h2 class="m3-title-lg" id="template-modal-title">Add New Template</h2>
                    <button id="close-template-modal-btn" class="m3-icon-btn m3-state"><i class="material-icons">close</i></button>
                </div>
                <div class="m3-dialog-content">
                    <input type="hidden" id="template-id-input">
                    <div class="m3-field" style="margin-bottom: var(--m3-gap-4);">
                        <label for="template-name-input">Template Name</label>
                        <input id="template-name-input" type="text" >
                    </div>
                    <div class="m3-field">
                        <label for="template-prompt-input">Template Prompt</label>
                        <textarea id="template-prompt-input" rows="6"></textarea>
                    </div>
                </div>
                <div class="m3-dialog-actions">
                    <button id="save-template-btn" type="button" class="m3-btn m3-btn--filled m3-state">
                        <span>Save Template</span>
                    </button>
                </div>
            </div>
        </div>

    </div>
    <script type="module" src="index.js"></script>
  </body>
</html>
